<!-- Template used to view & edit org user details -->

{{$time := FormatTime .user.CreatedAt "2 Jan, 2006 at 3:04:00 PM (MST)"}}
<div class="private-portal-wrapper">
    <div class="container">
        <p class="mb-3 mt-3">
            <a href="/portal/private/users" class="breadcrumb-link">
                < Back to user list
            </a>
        </p>
        {{ if .errors }}
            {{ range $key, $errs := .errors }}
                <div class="alert alert-warning cart-error" role="alert">
                <i class="tyk-icon tykon tykon-warning "></i>
                <div class="alert__content">
                    <strong>{{$key}}</strong>
                    <ul>
                    {{ range $errs }}
                        <li>{{.}}</li>
                    {{ end }}
                    </ul>
                </div>
                </div>
            {{ end }}
        {{ end }}
        <div class="apps-wrapper__card-section mt-5">
            <div class="d-flex flex-row justify-content-between align-items-center flex-wrap mb-4">
                <h1 class="heading-large m-0">User details</h1>
                <div class="cta-btns-wrapper">
                    <a class="btn btn-primary-outline" href="{{ .user.ID }}/edit">
                        Edit details
                    </a>
                </div>
            </div>
            <div class="card p-0 mb-4">
                <div class="card-footer m-0 p-4">
                    <div class="d-flex flex-row justify-content-between align-items-center flex-wrap p-3 requests-row-section__info">
                        <div class="d-flex flex-column pr-3">
                            <h6 class="heading-small text-default mb-1">Name:</h6>
                        </div>
                        <div class="text-regular-14">
                            {{ .user.DisplayName }}
                        </div>
                    </div>
                    <div class="d-flex flex-row justify-content-between align-items-center flex-wrap p-3 requests-row-section__info">
                        <div class="d-flex flex-column pr-3">
                            <h6 class="heading-small text-default mb-1">Email:</h6>
                        </div>
                        <div class="text-regular-14">
                            {{ .user.Email }}
                        </div>
                    </div>
                    <div class="d-flex flex-row justify-content-between align-items-center flex-wrap p-3 requests-row-section__info">
                        <div class="d-flex flex-column pr-3">
                            <h6 class="heading-small text-default mb-1">Member since:</h6>
                        </div>
                        <div class="text-regular-14">
                            {{ $time }}
                        </div>
                    </div>
                    <div class="d-flex flex-row justify-content-between align-items-center flex-wrap p-3 requests-row-section__info">
                        <div class="d-flex flex-column pr-3">
                            <h6 class="heading-small text-default mb-1">Role:</h6>
                        </div>
                        <div class="text-regular-14 d-flex flex-row align-items-center">
                            {{ .user.DisplayRole }}
                            <i class="bi bi-question-circle-fill question-icon ml-1"></i>
                        </div>
                    </div>
                    <div class="d-flex flex-row justify-content-between align-items-center flex-wrap p-3 requests-row-section__info">
                        <div class="d-flex flex-column pr-3">
                            <h6 class="heading-small text-default mb-1">Status:</h6>
                        </div>
                        {{if .user.Active}}
                            <div class="text-regular-14 d-flex flex-row align-items-center">
                                <i class="bi bi-check-circle-fill status-registered"></i>
                                Registered
                            </div>
                        {{else}}
                            {{if .invite}}
                                {{if not .invite.Active}}
                                    <div class="text-regular-14 d-flex flex-row align-items-center">
                                        <i class="bi bi-check-circle-fill status-registered"></i>
                                        Registered
                                    </div>
                                {{else}}
                                    <div class="text-regular-14 d-flex flex-row align-items-center">
                                        <i class="bi bi-clock-fill status-pending"></i>
                                        Pending invite
                                    </div>
                                {{end}}
                            {{end}}
                        {{end}}
                    </div>
                </div>
            </div>
            <h2 class="heading-large mb-3">Advanced Settings</h2>
            {{if .user.Active}}
                <div class="card p-0 mb-4">
                    <div class="card-footer m-0 p-4 d-flex flex-row w-100 justify-content-between">
                        <div>
                            <h4 class="heading-medium text-default">Delete this user</h4>
                            <h5 class="body-xlarge-default">This developer will no longer be a part of this organisation and will lose access to the credentials for any given app.</h5>
                        </div>
                        <div>
                            <button type="button" class="btn btn-danger-outline" data-toggle="modal" data-target="#deleteDeveloperModal">
                                Delete this user
                            </button>
                        </div>
                    </div>
                </div>
            {{else}}
                {{if .invite}}
                    {{if not .invite.Active}}
                        <div class="card p-0 mb-4">
                            <div class="card-footer m-0 p-4 d-flex flex-row w-100 justify-content-between">
                                <div>
                                    <h4 class="heading-medium text-default">Delete this user</h4>
                                    <h5 class="body-xlarge-default">This developer will no longer be a part of this organisation and will lose access to the credentials for any given app.</h5>
                                </div>
                                <div>
                                    <button type="button" class="btn btn-danger-outline" data-toggle="modal" data-target="#deleteDeveloperModal">
                                        Delete this user
                                    </button>
                                </div>
                            </div>
                        </div>
                    {{end}}
                {{end}}
            {{end}}
        </div>
    </div>
</div>

{{ render "confirmation_modal" (dict
  "id" "deleteDeveloperModal"
  "title" "Delete this team-member from this org?"
  "body" (raw "<p class='text-regular-14'>By removing this developer from the organisation they will no longer have access to the apps and credentials associated with this org.</p><p class='text-regular-14'>Do you wish to continue?</p>")
  "confirmText" "Delete"
  "confirmClass" "btn-danger"
  "showIcon" true
  "useForm" true
  "hiddenFields" (dict "mode" "delete")
) }}