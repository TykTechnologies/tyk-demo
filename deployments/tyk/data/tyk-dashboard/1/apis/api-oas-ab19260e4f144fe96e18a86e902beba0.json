{
  "components": {},
  "info": {
    "title": "Streams - Bidirectional",
    "version": "1.0.0"
  },
  "openapi": "3.0.3",
  "paths": {},
  "servers": [
    {
      "url": "http://tyk-gateway.localhost:8080/streams-bidirectional/"
    }
  ],
  "x-tyk-api-gateway": {
    "info": {
      "dbId": "6707f30a455b670001e48f40",
      "id": "ab19260e4f144fe96e18a86e902beba0",
      "name": "Streams - Bidirectional",
      "orgId": "5e9d9544a1dcd60001d0ed20",
      "state": {
        "active": true
      }
    },
    "middleware": {
      "global": {
        "contextVariables": {
          "enabled": true
        },
        "trafficLogs": {
          "enabled": true
        }
      }
    },
    "server": {
      "listenPath": {
        "strip": true,
        "value": "/streams-bidirectional/"
      }
    },
    "upstream": {
      "url": "http://httpbin/"
    }
  },
  "x-tyk-streaming": {
    "streams": {
      "In": {
        "input": {
          "http_server": {
            "path": "/event",
            "ws_path": "/ws"
          }
        },
        "output": {
          "kafka": {
            "addresses": [
              "kafka:9092"
            ],
            "topic": "jobs"
          }
        },
        "pipeline": {
          "processors": [
            {
              "mapping": "root = this\nroot.user_id = \"$tyk_context.request_data_user\"\nroot.job_id = uuid_v4()\n"
            }
          ]
        }
      },
      "Out": {
        "input": {
          "kafka": {
            "addresses": [
              "kafka:9092"
            ],
            "consumer_group": "$tyk_context.request_data_user",
            "topics": [
              "completed"
            ]
          }
        },
        "output": {
          "http_server": {
            "path": "/event",
            "ws_path": "/ws"
          }
        },
        "pipeline": {
          "processors": [
            {
              "mapping": "root = if this.user_id != \"$tyk_context.request_data_user\" {\n    deleted()\n}\n"
            }
          ]
        }
      },
      "Worker": {
        "input": {
          "kafka": {
            "addresses": [
              "kafka:9092"
            ],
            "consumer_group": "worker",
            "topics": [
              "jobs"
            ]
          }
        },
        "output": {
          "kafka": {
            "addresses": [
              "kafka:9092"
            ],
            "topic": "completed"
          }
        },
        "pipeline": {
          "processors": [
            {
              "mapping": "root = this.merge({ \"result\": \"bar\" })\n"
            }
          ]
        }
      }
    }
  }
}
